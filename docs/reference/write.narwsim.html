<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Export simulation data — write.narwsim • narwind</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Export simulation data — write.narwsim"><meta property="og:description" content="Writes outputs from the individual-based model to an .xlsx file on disk."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">narwind</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/narwind.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/narw_density.html">NARW density in Canada</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Export simulation data</h1>
    
    <div class="hidden name"><code>write.narwsim.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Writes outputs from the individual-based model to an .xlsx file on disk.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for narwsim</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/write.html" class="external-link">write</a></span><span class="op">(</span><span class="va">obj</span>, prefix <span class="op">=</span> <span class="st">"narwsim"</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>obj</dt>
<dd><p>An object of class <code>narwsim</code>, as returned by <code><a href="narw.html">narw</a></code>.</p></dd>


<dt>prefix</dt>
<dd><p>Character string. Output file name. Defaults to <code>"narwsim"</code>.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments passed to <code><a href="https://rdrr.io/pkg/openxlsx/man/write.xlsx.html" class="external-link">write.xlsx</a></code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>One Excel file per population cohort. It is recommended to only use this function for short simulation runs (<code>nsim = 100</code> or less, or to use the <code>cohort</code> and <code>whale</code> arguments to extract data for specific individuals/cohorts. Each output file contains multiple sheets capturing all simulation parameters, as follows:</p><ul><li><p><code>Attributes</code>: day, date, month, unique whale ID, cohort ID, alive (yes/no), age, starve (yes/no), mortality from other sources (yes/no), probability of death from other sources, body condition, body length, coefficients of the length-at-age function, total mass, lean mass, fat mass, coefficients of the mass-at-length function, mouth radius, mouth opening angle, mouth width, migration to SEUS (yes/no), migration to GSL (yes/no)</p></li>
<li><p><code>Attributes_calf</code> same as <code>Attributes</code>, for calves</p></li>
<li><p><code>Movements</code>: easting,	northing, region, distance traveled, swim speed</p></li>
<li><p><code>Behavior</code>: proportion of time spent gliding, proportion of time spent gliding during foraging, proportion of time spent gliding while swimming in echelon position, time spent traveling, time spent feeding, time spent resting/nursing</p></li>
<li><p><code>Stressors</code>: Probability of entanglement, daily energetic cost of entanglement, entanglement event (yes/no), site of attachement (head/not head), entanglement serverity, entanglement duration, day of entanglement start, day of entanglement end, vessel strike	risk,	incidence of strike, incidence of behavioral response to noise, received sound level, threshold of response</p></li>
<li><p><code>Energy</code>: Daily energy balance, daily energy intake, daily energy expenditure, resting metabolic rate, locomotory costs, scalar applied to locomotory costs, stroke rate, stroke rate during foraging, energetic cost of somatic growth, total energetic cost of gestation, energetic costs of fetus growth and placental maintenance, heat increment of gestation, energetic cost of lactation, relative proportions of bones, viscera and muscles in lean mass</p></li>
<li><p><code>Energy_calf</code> same as <code>Energy</code>, for calves (where relevant)</p></li>
<li><p><code>Feeding</code>: incidence of foraging, prey concentration, minimum prey threshold that triggers foraging, size of the mouth gape, swimming speed while foraging, prey capture efficiency, reduction in the mouth gape during a head entanglement, feeding effort, feed_effort, coefficients of the feeding effort curve, target body condition, average mass of copepods, energy content of copepods, digestive efficiency, metabolizing efficiency	for juveniles and adults (heat increment of feeding)</p></li>
<li><p><code>Growth</code>: change in fat mass, daily change in lean mass, anabolism efficiency, catabolism efficiency</p></li>
<li><p><code>Growth_calf</code> same as <code>Growth</code>, for calves</p></li>
<li><p><code>Gestation</code>: incidence of abortion, fetus length, fetus mass, change in fetus mass, change in fetus length, predicted birth length, predicted birth mass, mass of muscles, viscera, bones, and blubber in fetal tissues, proportions of lipid and protein in fetal muscles, viscera, bones, bones, and blubber.</p></li>
<li><p><code>Lactation</code>: duration of lactation, milk assimilation ratem milk provision rate, factor defining the nonlinearity between milk supply and body condition of the mother, age at which milk consumption starts to decrease, factor defining the nonlinearity between milk assimilation and calf age, mass of mammary glands, mammary efficiency, milk production rate, time spent nursing, target body condition (calf), proportions of protein and lipids in milk</p></li>
</ul></div>
    <div id="note">
    <h2>Note</h2>
    <p>This function</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Phil J. Bouchet</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">narwind</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="narw.html">narw</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/write.html" class="external-link">write</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by P. Bouchet, E. Pirotta, J. Hewitt, R. Schick, C. Harris, L. Thomas.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

