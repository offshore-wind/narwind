<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>3. Running the model • narwind</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="3. Running the model">
<meta property="og:description" content="narwind">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">narwind</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/narwind.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/model_overview.html">1. Overview and workflow</a>
    </li>
    <li>
      <a href="../articles/scenarios.html">2. Defining scenarios</a>
    </li>
    <li>
      <a href="../articles/model_run.html">3. Running the model</a>
    </li>
    <li>
      <a href="../articles/model_summary.html">4. Summary and diagnostics</a>
    </li>
    <li>
      <a href="../articles/model_predictions.html">5. Model predictions</a>
    </li>
    <li>
      <a href="../articles/model_export.html">6. Exporting data</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="model_run_files/font-awesome-5.13.0/js/script.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>3. Running the model</h1>
                        <h4 data-toc-skip class="author">Phil Bouchet,
Enrico Pirotta, Catriona Harris, Len Thomas</h4>
            <address class="author_afil">
      Centre for Research into Ecological &amp; Environmental Modelling,
University of St Andrews<br><h4 data-toc-skip class="date">2024-04-25</h4>
      
      
      <div class="hidden name"><code>model_run.Rmd</code></div>

    </address>
</div>

    
    
<a href="https://raw.githubusercontent.com/offshore-wind/narwind/1240faf44d7afb030838ae2fdcf58a12a2ab9b1e/vignettes/pdf/model_run.pdf" class="external-link">
<button class="btn btn-primary"><i class="fa fa-file-pdf"></i> Download PDF</button>
</a>
<div class="section level2">
<h2 id="preamble">Preamble<a class="anchor" aria-label="anchor" href="#preamble"></a>
</h2>
<p>This tutorial demonstrates how to run the agent-based model within
the <code>narwind</code> R package.</p>
</div>
<div class="section level2">
<h2 id="running-the-model">Running the model<a class="anchor" aria-label="anchor" href="#running-the-model"></a>
</h2>
<p>Once the package is loaded (see Tutorial 1), the agent-based model is
run by calling the <code><a href="../reference/narw.html">narw()</a></code> function. By default, the model
will simulate n = 1,000 individuals for each of the six population
cohorts considered, under baseline conditions reflecting the absence of
any wind farm development activity. This default model can be run by
typing:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_base</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/narw.html">narw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Several arguments can be passed to <code><a href="../reference/narw.html">narw()</a></code>, as listed
below. We detail each of them in subsequent sections.</p>
<table class="table">
<colgroup>
<col width="26%">
<col width="26%">
<col width="47%">
</colgroup>
<thead><tr class="header">
<th>Argument</th>
<th>Default value</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>nsim</code></td>
<td><code>1000</code></td>
<td>Positive integer. Number of simulated animals.</td>
</tr>
<tr class="even">
<td><code>scenario</code></td>
<td><code>NULL</code></td>
<td>An optional scenario object, as returned by the
<code><a href="../reference/scenario.html">scenario()</a></code> function.</td>
</tr>
<tr class="odd">
<td><code>label</code></td>
<td><code>""</code></td>
<td>Character. Text label assigned to the simulation object; used for
plotting.</td>
</tr>
<tr class="even">
<td><code>piling.hrs</code></td>
<td><code>4</code></td>
<td>Numeric. Length of time (hours) during which whales cease foraging
following a response to pile-driving noise exposure.</td>
</tr>
<tr class="odd">
<td><code>n.cores</code></td>
<td><code>NULL</code></td>
<td>Positive integer. Number of CPU cores to use for parallel
processing. The default value of <code>NULL</code> detects the processor
configuration and runs computations on the maximum allowable number of
available cores.</td>
</tr>
<tr class="even">
<td><code>cease.nursing</code></td>
<td><code>c(FALSE, piling.hrs)</code></td>
<td>Vector of length two. The first element indicates whether
(<code>TRUE</code>) or not (<code>FALSE</code>) nursing behavior is
interrupted in response to pile-driving noise exposure. The second
indicates how long the nursing cessation period lasts.</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="number-of-agents">Number of agents<a class="anchor" aria-label="anchor" href="#number-of-agents"></a>
</h3>
<p>The <code>nsim</code> argument controls the number of simulated
animals and is set to <code>1,000</code> by default. Users can override
this setting, however we recommend against using values of
<code>nsim &lt; 1000</code> as this is the minimum number of virtual
agents required for reliable inference. Below is an example of a smaller
simulation for 10 individuals only.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_base_10</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/narw.html">narw</a></span><span class="op">(</span>nsim <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="offshore-wind-scenario">Offshore wind scenario<a class="anchor" aria-label="anchor" href="#offshore-wind-scenario"></a>
</h3>
<p>The <code>scenario</code> argument is used to run models that entail
wind farm construction activities. Scenario objects must be created
using the <code><a href="../reference/scenario.html">scenario()</a></code> function described in the previous
tutorial, but note that three preset scenarios are available in the
package for demonstration purposes (see Tutorial 2). The code snippet
below shows how to run the agent-based model for the first of the three
preset scenarios that come with the package:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_scenario_01</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/narw.html">narw</a></span><span class="op">(</span>nsim <span class="op">=</span> <span class="fl">1000</span>, scenario <span class="op">=</span> <span class="va">scenario_01</span><span class="op">)</span></span></code></pre></div>
<p>To save model results, remember that calls to <code><a href="../reference/narw.html">narw()</a></code>
must be assigned to an R object using the assignment <code>&lt;-</code>
operator. In the examples above, we stored model outputs in a custom
object arbitrarily named <code>model_scenario_01</code>.</p>
</div>
<div class="section level3">
<h3 id="labeling">Labeling<a class="anchor" aria-label="anchor" href="#labeling"></a>
</h3>
<p>Simulation outputs can be labelled using the <code>label</code>
argument. This is useful for plotting purposes, for example when
comparing population trends obtained from different wind scenarios.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/narw.html">narw</a></span><span class="op">(</span>nsim <span class="op">=</span> <span class="fl">1000</span>, label <span class="op">=</span> <span class="st">"Example"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="duration-of-piling">Duration of piling<a class="anchor" aria-label="anchor" href="#duration-of-piling"></a>
</h3>
<p>We assume that a single pile in installed per day, and that the
maximum duration of piling operations is 4 hours. Importantly, this
defines the duration length of time during which whales will cease
foraging following a response to pile-driving noise exposure. To
increase/decrease this duration, set the <code>piling.hrs</code>
argument to a different value. For instance:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/narw.html">narw</a></span><span class="op">(</span>nsim <span class="op">=</span> <span class="fl">1000</span>, piling.hrs <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="parallel-computing">Parallel computing<a class="anchor" aria-label="anchor" href="#parallel-computing"></a>
</h3>
<p>The agent-based model is set up to run simulations in parallel on
multiple cores. To maximize efficiency, the package will maximize the
number of cores used relative to availability (i.e., 6 cores will be
used on machines with more than 6 cores available, 2 cores fewer than
the maximum available elsewhere). The number of cores used for parallel
computations can be changed via the <code>n.cores</code> argument.
Setting <code>n.cores</code> to a lower value will reduce impact on
overall machine performance but will increase the duration of model
runs.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/narw.html">narw</a></span><span class="op">(</span>nsim <span class="op">=</span> <span class="fl">1000</span>, n.cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p><strong>Note 3.1:</strong> A simulation of 1000 agents using 6 cores
takes approx. 1 hr 37 mins on a 2021 iMac (M1) running Mac OS Sonoma
14.1.2. However, run times may vary between operating systems. In
general, <code>narwind</code> performs more efficiently on machines
running Mac OS or Linux. We recommend the use of these operating systems
wherever possible.</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="nursing-cessation-not-recommended">Nursing cessation (not recommended)<a class="anchor" aria-label="anchor" href="#nursing-cessation-not-recommended"></a>
</h3>
<p>Although there is mounting evidence that disturbance from
noise-generating activities may heighten the risk of mother–calf pair
separation and limit the time available for suckling in other baleen
whale species, it is not currently known whether pile driving (or other
noise sources such as seismic surveys) can cause complete interruption
of nursing. In the absence of information, we assume that nursing is
unaffected by noise. However, we built the model with the option to
override this default. The <code>cease.nursing</code> argument can be
used to impose an arbitrary nursing cessation period. However, we advise
against doing so until a dedicated dose-response function that
characterizes changes in nursing behavior can be estimated.</p>
<p>The code below shows the correct syntax for this argument, which
contains two elements:</p>
<ul>
<li><p>The first element indicates whether (<code>TRUE</code>) or not
(<code>FALSE</code>) nursing behavior is interrupted in response to
pile-driving noise exposure.</p></li>
<li><p>The second indicates how long the nursing cessation period
lasts.</p></li>
</ul>
<p>Those elements need to be specified using the <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code>
function (which stands for ‘concatenate’).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/narw.html">narw</a></span><span class="op">(</span>nsim <span class="op">=</span> <span class="fl">1000</span>, cease.nursing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="disturbance-scenarios">Disturbance scenarios<a class="anchor" aria-label="anchor" href="#disturbance-scenarios"></a>
</h2>
<p>The code below runs models for each of the three preset offshore wind
scenarios, as well a baseline scenario. Each run is labelled
appropriately.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_base</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/narw.html">narw</a></span><span class="op">(</span><span class="fl">1000</span>, label  <span class="op">=</span> <span class="st">"Baseline"</span><span class="op">)</span></span>
<span><span class="va">model_01</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/narw.html">narw</a></span><span class="op">(</span><span class="fl">1000</span>, scenario <span class="op">=</span> <span class="va">scenario_01</span>, label <span class="op">=</span> <span class="st">"Scenario 01"</span><span class="op">)</span></span>
<span><span class="va">model_02</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/narw.html">narw</a></span><span class="op">(</span><span class="fl">1000</span>, scenario <span class="op">=</span> <span class="va">scenario_02</span>, label <span class="op">=</span> <span class="st">"Scenario 02"</span><span class="op">)</span></span>
<span><span class="va">model_03</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/narw.html">narw</a></span><span class="op">(</span><span class="fl">1000</span>, scenario <span class="op">=</span> <span class="va">scenario_03</span>, label <span class="op">=</span> <span class="st">"Scenario 03"</span><span class="op">)</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by P. Bouchet, E. Pirotta, J. Hewitt, R. Schick, C. Harris, L. Thomas.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
