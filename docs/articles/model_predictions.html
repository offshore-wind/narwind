<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>5. Model predictions • narwind</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="5. Model predictions">
<meta property="og:description" content="narwind">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">narwind</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/narwind.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/model_overview.html">1. Overview and workflow</a>
    </li>
    <li>
      <a href="../articles/scenarios.html">2. Defining scenarios</a>
    </li>
    <li>
      <a href="../articles/model_run.html">3. Running the model</a>
    </li>
    <li>
      <a href="../articles/model_summary.html">4. Summary and diagnostics</a>
    </li>
    <li>
      <a href="../articles/model_predictions.html">5. Model predictions</a>
    </li>
    <li>
      <a href="../articles/model_export.html">6. Exporting data</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="model_predictions_files/font-awesome-5.13.0/js/script.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>5. Model predictions</h1>
                        <h4 data-toc-skip class="author">Phil Bouchet,
Enrico Pirotta, Catriona Harris, Len Thomas</h4>
            <address class="author_afil">
      Centre for Research into Ecological &amp; Environmental Modelling,
University of St Andrews<br><h4 data-toc-skip class="date">2024-04-25</h4>
      
      
      <div class="hidden name"><code>model_predictions.Rmd</code></div>

    </address>
</div>

    
    
<a href="https://raw.githubusercontent.com/offshore-wind/narwind/1240faf44d7afb030838ae2fdcf58a12a2ab9b1e/vignettes/pdf/model_predictions.pdf" class="external-link">
<button class="btn btn-primary"><i class="fa fa-file-pdf"></i> Download PDF</button>
</a>
<div class="section level2">
<h2 id="preamble">Preamble<a class="anchor" aria-label="anchor" href="#preamble"></a>
</h2>
<p>This tutorial demonstrates how to generate predictions of right whale
abundance using the stochastic population model available in
<code>narwind</code>.</p>
</div>
<div class="section level2" data-link="Exporting data">
<h2 id="quantifying-uncertainty">Quantifying uncertainty<a class="anchor" aria-label="anchor" href="#quantifying-uncertainty"></a>
</h2>
<p>When a run of the agent-based model completes, generalized additive
models (GAMs) are fitted to simulation outputs to assess how the initial
health of individuals within each population cohort affected their body
condition and survival trajectories across the year. The fitted GAMs are
critical as they inform the stochastic population model used to yield
projections of future right whale population size.</p>
<p>Forward propagation of the uncertainty associated with GAM
coefficients is important for decision-making, and can be achieved using
the <code>augment()</code> function. <code>augment()</code> performs
random draws from the posterior distributions of GAM coefficients using
a Bayesian Metropolis-Hastings algorithm and returns replicate
realizations of the fitted smooths. See the accompanying project report
and the R help pages for technical details.</p>
<p>The code below shows how to use <code>augment()</code> in practice.
Note that the assignment operator <code>&lt;-</code> must once again be
used to save the outputs of the function. To keep everything tidy and
avoid using unnecessary memory, we assign those outputs back to the
<code>model_base</code> object, effectively “augmenting” the object with
new data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_base</span> <span class="op">&lt;-</span> <span class="fu">augment</span><span class="op">(</span><span class="va">model_base</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p><strong>Note 5.1:</strong> The use of <code>augment()</code> is not
compulsory but is highly recommended. Population projections obtained
without running <code>augment()</code> first will only account for
process variance (i.e., the uncertainty resulting from replicate
projections) and will return a warning.</p>
</blockquote>
<p>The object <code>model_base</code> now contains an additional
component (called <code>post</code>, as shown below), which stores the
posterior draws of the model coefficients.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">model_base</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 10</span></span>
<span><span class="co">#&gt;  $ sim     :List of 6</span></span>
<span><span class="co">#&gt;  $ gam     :List of 2</span></span>
<span><span class="co">#&gt;  $ dead    :Classes 'data.table' and 'data.frame':   610 obs. of  25 variables:</span></span>
<span><span class="co">#&gt;   ..- attr(*, ".internal.selfref")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;   ..- attr(*, "index")= int(0) </span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "__whale")= int [1:610] 146 319 441 118 39 442 1 320 194 195 ...</span></span>
<span><span class="co">#&gt;  $ birth   :Classes 'data.table' and 'data.frame':   1000 obs. of  25 variables:</span></span>
<span><span class="co">#&gt;   ..- attr(*, ".internal.selfref")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;   ..- attr(*, "sorted")= chr "cohort"</span></span>
<span><span class="co">#&gt;   ..- attr(*, "index")= int(0) </span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "__cohort__whale")= int(0) </span></span>
<span><span class="co">#&gt;  $ abort   :Classes 'data.table' and 'data.frame':   1000 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   ..- attr(*, ".internal.selfref")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ param   :List of 11</span></span>
<span><span class="co">#&gt;  $ init    :List of 3</span></span>
<span><span class="co">#&gt;  $ run     : 'hms' num 01:33:14</span></span>
<span><span class="co">#&gt;   ..- attr(*, "units")= chr "secs"</span></span>
<span><span class="co">#&gt;  $ scenario:List of 12</span></span>
<span><span class="co">#&gt;   ..- attr(*, "class")= chr [1:2] "narwscenario" "list"</span></span>
<span><span class="co">#&gt;  $ post    :List of 7</span></span>
<span><span class="co">#&gt;  - attr(*, "class")= chr [1:2] "narwsim" "list"</span></span>
<span><span class="co">#&gt;  - attr(*, "seed")= int 9443</span></span></code></pre></div>
</div>
<div class="section level2" data-link="Exporting data">
<h2 id="predicting-abundance">Predicting abundance<a class="anchor" aria-label="anchor" href="#predicting-abundance"></a>
</h2>
<p>The <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> method implements a stochastic population
model which allows users to generate projections of right whale
abundance over a time horizon of interest.</p>
<p>The table below details the arguments that <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code>
accepts.</p>
<table class="table">
<colgroup>
<col width="23%">
<col width="23%">
<col width="52%">
</colgroup>
<thead><tr class="header">
<th>Argument</th>
<th>Default value</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>obj</code></td>
<td><code>-</code></td>
<td>One or more objects of class <code>narwsim</code>, as returned by
<code><a href="../reference/narw.html">narw()</a></code>.</td>
</tr>
<tr class="even">
<td><code>n</code></td>
<td><code>100</code></td>
<td>Integer. Number of replicates projections.</td>
</tr>
<tr class="odd">
<td><code>yrs</code></td>
<td><code>35</code></td>
<td>Integer. Time horizon, specified either as the desired number of
years (from current) or the desired target end year. Defaults to
<code>35</code>, which is commensurate with the expected average
lifespan of a typical wind farm.</td>
</tr>
<tr class="even">
<td><code>param</code></td>
<td><code>TRUE</code></td>
<td>If <code>TRUE</code>, prediction variance includes parameter
uncertainty.</td>
</tr>
<tr class="odd">
<td><code>piling</code></td>
<td><code>1</code></td>
<td>Integer. Year of construction. By default, piling occurs on the
first year of the projection, followed by operation and maintenance for
the remainder.</td>
</tr>
<tr class="even">
<td><code>progress</code></td>
<td><code>TRUE</code></td>
<td>Logical. If <code>TRUE</code>, a progress bar is printed to the R
console during execution.</td>
</tr>
</tbody>
</table>
<div class="section level4">
<h4 id="projection-horizon">Projection horizon<a class="anchor" aria-label="anchor" href="#projection-horizon"></a>
</h4>
<p>By default, projections are set to 35 years (from current), as this
aligns with the average expected lifespan of a typical wind farm.
Longer/shorter projections can be obtained by modifying the
<code>yrs</code> argument, which can either be specified as a desired
number of years or as a target year for the end of the projection.</p>
<p>For instance, the two lines of code below are equivalent and yield
predictions of population size over the next 50 years (given that the
current year at the time of writing is 2024).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">preds_50years</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model_base</span>, yrs <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">preds_50years</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model_base</span>, yrs <span class="op">=</span> <span class="fl">2074</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="replicate-projections">Replicate projections<a class="anchor" aria-label="anchor" href="#replicate-projections"></a>
</h4>
<p>In <code>narwind</code>, prediction uncertainty is estimated from
both process variance (i.e., repeat projections) and parameter
uncertainty (i.e., statistical uncertainty in the relationships between
individual body condition and health/survival, respectively). The latter
is considered only if replicate coefficients have been sampled from the
posteriors of the fitted survival and body condition GAMs using the
<code>augment()</code> function (see previous section).</p>
<p>The <code>n</code> argument controls the number of replicate
projections and is set to <code>100</code> by default. Generating a
single projection instead is straightforward, as shown here:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">preds_n1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model_base</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="schedule-of-development">Schedule of development<a class="anchor" aria-label="anchor" href="#schedule-of-development"></a>
</h4>
<p>Population projections involve three successive phases: a baseline
phase without wind farm activity between 2019 and the current year
(e.g., 2024), followed by an optional, one-year construction phase, and
an operational phase that lasts for the remainder of the projection. The
timing of construction and operation and maintenance activities within
the time horizon of a projection is defined by the ** scenario bundle**
(i.e., one or more R objects containing the outputs of one or more runs
of the agent-based model) which is passed to <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code>.</p>
<p>There are several possible options:</p>
<ul>
<li>
<p><strong>Baseline conditions only</strong> – no wind farm
development activities occur during the projection. This only requires a
single run of the agent-based model (and therefore a single R object).
For example, using the <code>model_baseline</code> object created in
previous tutorials:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">proj_baseline</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model_base</span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p><strong>Operation and maintenance only</strong> – no construction
activities are considered, however maintenance and servicing operations
apply throughout the projection. This requires two runs of the
agent-based model (and therefore, two R objects), corresponding to
baseline conditions and an operation scenario (e.g., the third preset
scenario within the package), respectively. Multiple R objects can be
given in sequence, separated by commas:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">proj_OM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model_base</span>, <span class="va">model_03</span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p><strong>Construction, followed by 0&amp;M.</strong> Here, piling
activities take place during a single year, and are followed by
maintenance operations for the remainder. By default,
<code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> assumes that piling occurs at the onset of the
projection (i.e., in year 1, the current year), such that the
<code>piling</code> argument is set to <code>1</code>. Three separate
runs of the agent-based model are needed in this instance, for baseline
conditions, a construction scenario (e.g., <code>model_01</code>), and
an operation scenario (e.g., <code>model_03</code>) respectively. For
example</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">proj_construction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model_base</span>, <span class="va">model_01</span>, <span class="va">model_03</span><span class="op">)</span></span></code></pre></div>
</li>
</ul>
<blockquote>
<p><strong>Note 5.2:</strong> <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> cannot process more
than one scenario <strong>bundle</strong> at a time. Therefore, separate
calls to <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> must be made to compare population
projections for multiple, alternative scenarios such as those involving
different schedules of piling, different wind farm sites etc.</p>
</blockquote>
</div>
</div>
<div class="section level2">
<h2 id="plotting-projections">Plotting projections<a class="anchor" aria-label="anchor" href="#plotting-projections"></a>
</h2>
<p>Population trends can be visualized using the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>
command, which takes the following arguments:</p>
<table class="table">
<colgroup>
<col width="23%">
<col width="23%">
<col width="52%">
</colgroup>
<thead><tr class="header">
<th>Argument</th>
<th>Default value</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>diff</code></td>
<td><code>FALSE</code></td>
<td>Logical. If <code>TRUE</code>, returns plots of the differences
between pairs of projections. Defaults to <code>FALSE</code>.</td>
</tr>
<tr class="even">
<td><code>interval</code></td>
<td><code>TRUE</code></td>
<td>Logical. If <code>TRUE</code>, percentile confidence intervals are
shown on the plots.</td>
</tr>
<tr class="odd">
<td><code>shade</code></td>
<td><code>TRUE</code></td>
<td>Logical. If <code>TRUE</code>, confidence intervals are displayed as
colored ribbons. Otherwise, confidence bounds are shown as dotted
lines.</td>
</tr>
<tr class="even">
<td><code>cohort</code></td>
<td><code>FALSE</code></td>
<td>Logical. If <code>TRUE</code>, separate plots are returned for each
population cohort. If <code>FALSE</code>, a single plot of the overall
population trend is shown.</td>
</tr>
<tr class="odd">
<td><code>noaa</code></td>
<td><code>FALSE</code></td>
<td>Logical. If <code>TRUE</code> the population trajectory predicted as
part of NOAA’s population viability analysis (Runge et al., 2023) is
also plotted. Defaults to <code>FALSE</code>.</td>
</tr>
<tr class="even">
<td><code>full</code></td>
<td><code>FALSE</code></td>
<td>Logical. If <code>TRUE</code>, the trend plot includes historical
population size estimates (dating back to 2000).</td>
</tr>
<tr class="odd">
<td><code>timeline</code></td>
<td><code>FALSE</code></td>
<td>Logical. If <code>TRUE</code>, the plot includes timeline(s) of
offshore wind development.</td>
</tr>
<tr class="even">
<td><code>timeline.y</code></td>
<td><code>0</code></td>
<td>Numeric. Position of the timeline on the y-axis.</td>
</tr>
<tr class="odd">
<td><code>scales</code></td>
<td><code>"free"</code></td>
<td>Character. Defines whether axis scales should be constant or vary
across plots. Can be one of <code>"fixed"</code> or <code>"free"</code>
(the default).</td>
</tr>
<tr class="even">
<td><code>ncol</code></td>
<td><code>3</code></td>
<td>Integer. Number of columns for the plot layout when
<code>cohort = TRUE</code>.</td>
</tr>
<tr class="odd">
<td><code>nx</code></td>
<td><code>5</code></td>
<td>Integer. Desired number of x-axis intervals. Non-integer values are
rounded down.</td>
</tr>
<tr class="even">
<td><code>ny</code></td>
<td><code>5</code></td>
<td>Integer. Desired number of y-axis intervals. Non-integer values are
rounded down.</td>
</tr>
</tbody>
</table>
<p>By default, a simple call to <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> will return the
overall population trend.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">proj_base</span><span class="op">)</span></span></code></pre></div>
<p><img src="model_predictions_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>When set to <code>TRUE</code>, the <code>cohort</code> argument shows
time series of abundance for each population cohort, rather than for the
whole population.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">proj_base</span>, cohort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="model_predictions_files/figure-html/poptrends_cohort-1.png" width="768"></p>
<p>The <code>interval</code> argument can be set to <code>FALSE</code>
to hide confidence intervals around the trend.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">proj_base</span>, interval <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="model_predictions_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>Setting the <code>noaa</code> argument to <code>TRUE</code> will
overlay the population trend estimated by <span class="citation">Runge
<em>et al.</em> (<a href="#ref-Runge2023" role="doc-biblioref">2023</a>)</span>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">proj_base</span>, noaa <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="model_predictions_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>Multiple projections can be plotted together for comparison:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">proj_base</span>, <span class="va">proj_01</span>, <span class="va">proj_02</span>, <span class="va">proj_03</span><span class="op">)</span></span></code></pre></div>
<p><img src="model_predictions_files/figure-html/poptrends_all-1.png" width="700"></p>
<p>If needed, the schedule(s) of development can be displayed as well by
setting <code>timeline</code> to <code>TRUE</code>. Here, B = Baseline,
C = Construction, and O = Operation &amp; Maintenance.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">proj_base</span>, <span class="va">proj_01</span>, <span class="va">proj_02</span>, <span class="va">proj_03</span>, timeline <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="model_predictions_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>If labels are incorrect (or an error related to labeling occurs),
projections can be relabeled using the <code>label()</code> function,
which takes the projection object as the first argument, and the new
label (between quotation marks) as the second argument. Do not forget to
assign the output back to the original projection object to overwrite
the previous label. For example:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">proj_01</span> <span class="op">&lt;-</span> <span class="fu">label</span><span class="op">(</span><span class="va">proj_01</span>, <span class="st">"Scenario 01"</span><span class="op">)</span></span></code></pre></div>
<p>If predicted trends are similar, the resulting plot can be difficult
to interpret. An alternative way of comparing trends is to compute the
difference in predicted abundance between each pair of replicate
projections. This can be done by setting the <code>diff</code> argument
to <code>TRUE</code>. There is no evidence for a difference between
projections if the resulting confidence interval overlaps zero.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">proj_base</span>, <span class="va">proj_01</span>, <span class="va">proj_02</span>, <span class="va">proj_03</span>, diff <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Scale for <span style="color: #00BB00;">y</span> is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for <span style="color: #00BB00;">y</span>, which will replace the existing scale.</span></span></code></pre></div>
<p><img src="model_predictions_files/figure-html/unnamed-chunk-12-1.png" width="768"></p>
</div>
<div class="section level2">
<h2 id="summarizing-projections">Summarizing projections<a class="anchor" aria-label="anchor" href="#summarizing-projections"></a>
</h2>
<p>The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method also works on projections and
returns useful information on:</p>
<ul>
<li><p>Abundance estimates at the end of the projection, both for the
population as a whole and for each cohort.</p></li>
<li><p>Estimates of model parameters, including mortality, individual
health, and fecundity.</p></li>
<li><p>Estimates of the population’s probability of quasi-extinction,
i.e., the probability that the number of reproductive females falls
below N = 50 <span class="citation">(<a href="#ref-Runge2023" role="doc-biblioref">Runge <em>et al.</em> 2023</a>)</span>.</p></li>
</ul>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">proj_base</span><span class="op">)</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      NORTH ATLANTIC RIGHT WHALE (Eubalaena glacialis)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           *** POPULATION MODEL SUMMARY ***</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Replicates: N = 100 </span></span>
<span><span class="co">#&gt; Projection horizon: 35 years</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Timeline:</span></span>
<span><span class="co">#&gt; Baseline (yr 1 to 35)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; =============================================================</span></span>
<span><span class="co">#&gt; ABUNDANCE</span></span>
<span><span class="co">#&gt; =============================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Initial population size:</span></span>
<span><span class="co">#&gt; N = 356</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; cohort                          N</span></span>
<span><span class="co">#&gt; ---------------------------  ----</span></span>
<span><span class="co">#&gt; Calves (male)                   9</span></span>
<span><span class="co">#&gt; Juveniles (male)               45</span></span>
<span><span class="co">#&gt; Adults (male)                 168</span></span>
<span><span class="co">#&gt; Calves (female)                 8</span></span>
<span><span class="co">#&gt; Juveniles (female)             39</span></span>
<span><span class="co">#&gt; Adults (female, pregnant)      17</span></span>
<span><span class="co">#&gt; Adults (female, lactating)     13</span></span>
<span><span class="co">#&gt; Adults (female, resting)       57</span></span>
<span><span class="co">#&gt; Total                         356</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Final population size:</span></span>
<span><span class="co">#&gt; N = 153 (95% CI: 118 – 181)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; cohort                       N                     </span></span>
<span><span class="co">#&gt; ---------------------------  ----------------------</span></span>
<span><span class="co">#&gt; Calves (male)                2 (95% CI: 0 – 5)     </span></span>
<span><span class="co">#&gt; Juveniles (male)             10 (95% CI: 4 – 17)   </span></span>
<span><span class="co">#&gt; Adults (male)                85 (95% CI: 68 – 103) </span></span>
<span><span class="co">#&gt; Calves (female)              1 (95% CI: 0 – 4)     </span></span>
<span><span class="co">#&gt; Juveniles (female)           10 (95% CI: 4 – 16)   </span></span>
<span><span class="co">#&gt; Adults (female, pregnant)    3 (95% CI: 1 – 7)     </span></span>
<span><span class="co">#&gt; Adults (female, lactating)   3 (95% CI: 0 – 7)     </span></span>
<span><span class="co">#&gt; Adults (female, resting)     37 (95% CI: 23 – 48)  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; =============================================================</span></span>
<span><span class="co">#&gt; HEALTH &amp; MORTALITY</span></span>
<span><span class="co">#&gt; =============================================================</span></span></code></pre></div>
<p><img src="model_predictions_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; cohort    survival                  body condition            min condition (gestation)</span></span>
<span><span class="co">#&gt; --------  ------------------------  ------------------------  ---------------------------</span></span>
<span><span class="co">#&gt; c(m,f)    0.722 ± 0.233 [0–1]       0.29 ± 0.186 [0–0.613]    -</span></span>
<span><span class="co">#&gt; jv(ml)    0.976 ± 0.04 [0.714–1]    0.287 ± 0.073 [0–0.581]   -</span></span>
<span><span class="co">#&gt; jv(fml)   0.979 ± 0.038 [0.714–1]   0.293 ± 0.07 [0–0.637]    -</span></span>
<span><span class="co">#&gt; ad(ml)    0.966 ± 0.017 [0.893–1]   0.36 ± 0.087 [0–0.665]    -</span></span>
<span><span class="co">#&gt; ad(f,p)   0.972 ± 0.082 [0–1]       0.398 ± 0.104 [0–0.665]   -</span></span>
<span><span class="co">#&gt; ad(f,l)   0.907 ± 0.155 [0–1]       0.097 ± 0.047 [0–0.36]    -</span></span>
<span><span class="co">#&gt; ad(f,r)   0.955 ± 0.029 [0.8–1]     0.348 ± 0.095 [0–0.665]   0.496 ± 0.06 [0.161–0.713]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; =============================================================</span></span>
<span><span class="co">#&gt; FECUNDITY</span></span>
<span><span class="co">#&gt; =============================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Calving events</span></span>
<span><span class="co">#&gt; ----------------------------------</span></span>
<span><span class="co">#&gt; Per year: N = 4.8 ± 2.46 [0–17]</span></span>
<span><span class="co">#&gt; Per female: N = 0.38 ± 0.91 [0–8]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Resting phase</span></span>
<span><span class="co">#&gt; -----------------------------</span></span>
<span><span class="co">#&gt; t(rest): 5 ± 5 [1–39]</span></span>
<span><span class="co">#&gt; t(inter-birth): 8 ± 4 [2–40]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Non-reproductive females:</span></span>
<span><span class="co">#&gt; 4.28 (±1.02) [0–8] %</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Abortion    Simulation (%)  Projection (%)</span></span>
<span><span class="co">#&gt; ---------  ---------------  ---------------------</span></span>
<span><span class="co">#&gt; Baseline               2.3  2.8 (±10.28) [0–100]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; =============================================================</span></span>
<span><span class="co">#&gt; POPULATION VIABILITY </span></span>
<span><span class="co">#&gt; =============================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; year   p(quasi-extinct)</span></span>
<span><span class="co">#&gt; -----  -----------------</span></span>
<span><span class="co">#&gt; 2024               0.00</span></span>
<span><span class="co">#&gt; 2029               0.00</span></span>
<span><span class="co">#&gt; 2034               0.00</span></span>
<span><span class="co">#&gt; 2039               0.01</span></span>
<span><span class="co">#&gt; 2044               0.18</span></span>
<span><span class="co">#&gt; 2049               0.47</span></span>
<span><span class="co">#&gt; 2054               0.73</span></span>
<span><span class="co">#&gt; 2059               0.87</span></span></code></pre>
<p><img src="model_predictions_files/figure-html/unnamed-chunk-13-2.png" width="700"></p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Runge2023" class="csl-entry">
Runge MC, Linden DW, Hostetler JA, Borggaard DL, Garrison LP, Knowlton
AR, Lesage V, Williams R, Pace III RM (2023). A management-focused
population viability analysis for north atlantic right whales. Report.
DOI: <a href="https://doi.org/10.13140/RG.2.2.26635.05928" class="external-link">10.13140/RG.2.2.26635.05928</a>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by P. Bouchet, E. Pirotta, J. Hewitt, R. Schick, C. Harris, L. Thomas.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
